<!DOCTYPE html>
<html>
  <head>
    <script type="module">
      import * as svgcraft from './svgcraft.js';

      function setup_tile(tile, i, j, rng) {
          var e = tile.getElementsByTagName("ellipse")[0];
          if (e) {
              var rx = 2500 + 1500 * rng();
              var ry = 2000 + 1200 * rng();
              e.setAttribute("rx", rx);
              e.setAttribute("ry", ry);
              var rotCenterX = 4000 + 2000 * rng();
              var rotCenterY = 4000 + 2000 * rng();
              var t = `rotate(${rng()*360} ${rotCenterX} ${rotCenterY})`;
              e.setAttribute("transform", t);
              var txt = tile.getElementsByTagName("text")[0];
              txt.textContent =
                  (i >= 0 ? (i+1) + "E" : (-i) + "W") +
                  (j >= 0 ? (j+1) + "S" : (-j) + "N") +
                  " Island";
          }
      }

      window.onload = () => {
          svgcraft.init(setup_tile);
      }
    </script>
    <link rel="stylesheet" href="./svgcraft.css"/>
  </head>

  <body>
    <div id="mapport">
      <!-- width and height are ignored because overflow:visible -->
      <svg id="mainsvg" width="42" height="42"
           style="transform: translate(322px, 145px) scale(0.5);">

        <defs>
          <linearGradient id="WhiteToBlueGradient">
            <stop offset="5%" stop-color="white"/>
            <stop offset="95%" stop-color="blue"/>
          </linearGradient>

          <pattern id="BlueCircles" x="0" y="0" width="50" height="50" patternUnits="userSpaceOnUse">
            <rect x="0" y="0" width="50" height="50" fill="skyblue"/>
            <circle cx="25" cy="25" r="20" fill="url(#WhiteToBlueGradient)" fill-opacity="0.5"/>
          </pattern>

          <pattern id="SimpleBlueCircles" x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse">
            <circle cx="20" cy="20" r="20" fill="#64bee3" />
          </pattern>

          <pattern id="CobbledWestEast" x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse">
            <rect x="2" y="2" width="16" height="36" fill="#dddddd"/>
            <rect x="22" y="0" width="16" height="18" fill="#dddddd"/>
            <rect x="22" y="22" width="16" height="18" fill="#dddddd"/>
          </pattern>

          <pattern id="SquareWaveCobble" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse">
            <rect x="0" y="0" width="20" height="20" fill="#dddddd"/>
            <path d="M 10 0 l -2 5 l 4 10 l -2 5 M 0 10 l 5 2 l 10 -4 l 5 2"
                  stroke="#999999" stroke-width="1"
                  stroke-linejoin="round" stroke-linecap="round" fill="transparent"/>
          </pattern>

          <pattern id="Tiles1" x="0" y="0" width="150" height="150" patternUnits="userSpaceOnUse">
            <rect x="2"   y="2"   width="56" height="56" fill="#f3f3f3"/>
            <rect x="62"  y="32"  width="56" height="56" fill="#f3f3f3"/>
            <rect x="122" y="62"  width="56" height="56" fill="#f3f3f3"/>
            <rect x="-28" y="62"  width="56" height="56" fill="#f3f3f3"/>
            <rect x="32"  y="92"  width="56" height="56" fill="#f3f3f3"/>
            <rect x="92"  y="122" width="56" height="56" fill="#f3f3f3"/>
            <rect x="92"  y="-28" width="56" height="56" fill="#f3f3f3"/>
            <rect x="62"  y="2"   width="26" height="26" fill="#dddddd"/>
            <rect x="122" y="32"  width="26" height="26" fill="#dddddd"/>
            <rect x="32"  y="62"  width="26" height="26" fill="#dddddd"/>
            <rect x="92"  y="92"  width="26" height="26" fill="#dddddd"/>
            <rect x="2"   y="122" width="26" height="26" fill="#dddddd"/>
          </pattern>

          <pattern id="BlueCarpet1" x="0" y="0" width="12" height="12" patternUnits="userSpaceOnUse">
            <rect x="0" y="0" width="12" height="12" fill="#174062"/>
            <circle cx="3" cy="3" r="4.243" fill="#555555"/>
            <circle cx="9" cy="9" r="4.243" fill="#555555"/>
          </pattern>

          <pattern id="Lawn1" x="0" y="0" width="5" height="5" patternUnits="userSpaceOnUse">
            <rect x="0" y="0" width="5" height="5" fill="#56b000"/>
            <circle cx="-2" cy="0" r="5" stroke-width="1" stroke="#63c900" fill="none"/>
          </pattern>

          <pattern id="Ocean" x="0" y="0" width="80" height="40" patternUnits="userSpaceOnUse">
            <rect x="0" y="0" width="80" height="40" fill="#4dc3ff"/>
            <path d="M 3 9 c 6 -6, 11 -6, 17 0 s 11 6, 17 0"
                  stroke-width="4" stroke="#b3e6ff" stroke-linecap="round" fill="transparent"/>
            <path d="M 43 29 c 6 -6, 11 -6, 17 0 s 11 6, 17 0"
                  stroke-width="4" stroke="#b3e6ff" stroke-linecap="round" fill="transparent"/>
          </pattern>
        </defs>

        <style>
          @import url('https://fonts.googleapis.com/css?family=Patrick+Hand&display=swap');
          .IslandLabel {
              font-family: 'Patrick Hand', cursive;
              font-size: 30px;
              fill: #555
          }
        </style>

        <g id="TileTemplates">
          <g data-freq="5">
            <ellipse cx="5000" cy="5000" rx="1234" ry="1234" fill="#cccc00"/>
            <path d="M 5000 5000 l 0 -200" stroke="gray" stroke-width="18" fill="transparent"/>
            <rect x="4900" y="4750" width="200" height="50" rx="7" ry="7" stroke="gray" stroke-width="5" fill="white"/>
            <text x="4910" y="4785" class="IslandLabel"></text>
          </g>
          <g data-freq="1">
          </g>
        </g>

        <!-- width and height determine tile size.
             When user zooms out, the size of this rect will be increased. -->
        <rect id="BackgroundRect" x="0" y="0" width="10000" height="10000" fill="url(#Ocean)" />

        <g id="Tiles"/>

        <ellipse cx="0" cy="5000" rx="10000" ry="5000" fill="#cccc00"/>

        <circle cx="250" cy="50" r="40" stroke="green" stroke-width="4" fill="yellow" />

        <circle cx="500" cy="9000" r="40" stroke="green" stroke-width="4" fill="white" />

        <rect x="110" y="90" width="200" height="200" fill="url(#SimpleBlueCircles)" fill-opacity="0.5"/>

        <rect x="520" y="20" fill="url(#BlueCircles)" width="500" height="500" fill-opacity="0.5"/>

        <rect x="45" y="325" fill="url(#CobbledWestEast)" width="400" height="200"/>

        <rect x="-1000" y="550" width="858" height="1000" fill="url(#Lawn1)"/>
        <rect x="-1000" y="940" width="850" height="200" fill="url(#SquareWaveCobble)"/>

        <rect x="-138" y="550" fill="url(#Tiles1)" width="700" height="1000"/>
        <rect x="-160" y="550" width="20" height="1000" fill="url(#CobbledWestEast)"/>

        <rect x="300" y="550" width="400" height="1000" rx="9" ry="9" stroke="white" stroke-width="4"fill="url(#BlueCarpet1)"/>


      </svg>
    </div>
  </body>
</html>
